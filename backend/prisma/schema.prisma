// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id           Int          @id @default(autoincrement())
  email        String       @unique
  password     String
  name         String
  lastname     String
  avatar       String?
  birthday     DateTime
  country      Country
  relationship Relationship
  posts        Post[]       @relation("RelationAuthor")
  as_requester Friendship[] @relation("RelationRequester")
  as_requested Friendship[] @relation("RelationRequested")
  created_at   DateTime     @default(now())
  updated_at   DateTime     @updatedAt

  @@index([id, email])
}

model Friendship {
  requester          Int
  relation_requester User     @relation(name: "RelationRequester", fields: [requester], references: [id], onDelete: Cascade, onUpdate: Cascade)
  requested          Int
  relation_requested User     @relation(name: "RelationRequested", fields: [requested], references: [id], onDelete: Cascade, onUpdate: Cascade)
  status             Status
  created_at         DateTime @default(now())
  updated_at         DateTime @updatedAt

  @@id([requester, requested])
  @@index([requester, requested])
}

model Post {
  id              Int      @id @default(autoincrement())
  author          Int
  relation_author User     @relation(name: "RelationAuthor", fields: [author], references: [id], onDelete: Cascade, onUpdate: Cascade)
  content         String
  created_at      DateTime @default(now())

  @@index([author])
}

enum Country {
  Brasil
  Portugal
  Argentina
}

enum Relationship {
  Solteiro
  Namorando
  Casado
  Divorciado
  Viuvo
  Enrolado
}

enum Status {
  Pendente
  Aceito
  Recusado
  Desfeito
}
